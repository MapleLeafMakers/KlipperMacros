## Neopixel Temperature Indicator
# Usage:
# To begin monitoring a temperature:
# SET_LED_TEMPLATE LED=<led_name> [INDEX=<index>] TEMPLATE=temperature_color [param_sensor="'heater_bed'"] [param_cool_temp=20] [param_hot_temp=100]
# 
# To stop monitoring a temperature, and resume normal LED control
# SET_LED_TEMPLATE LED=<led_name> [INDEX=<index>] TEMPLATE=
#


[display_template temperature_color]
param_cool_temp: 20
param_hot_temp: 100
param_sensor: 'heater_bed'
param_gradient: [
  '0.01,0.00,1.00,0.00', '0.01,0.00,1.00,0.00', '0.02,0.02,1.00,0.00', '0.04,0.03,1.00,0.00', '0.05,0.05,1.00,0.00', '0.07,0.07,1.00,0.00', '0.09,0.10,1.00,0.00', '0.11,0.12,1.00,0.00', '0.13,0.15,1.00,0.00', '0.15,0.16,0.99,0.00', '0.17,0.18,0.99,0.00', 
  '0.19,0.21,0.99,0.00', '0.21,0.23,0.99,0.00', '0.24,0.25,0.99,0.00', '0.25,0.26,0.98,0.00', '0.27,0.29,0.98,0.00', '0.30,0.31,0.98,0.00', '0.32,0.33,0.97,0.00', '0.34,0.34,0.97,0.00', '0.36,0.36,0.97,0.00', '0.38,0.40,0.96,0.00', '0.39,0.47,0.96,0.00', 
  '0.40,0.52,0.96,0.00', '0.40,0.57,0.96,0.00', '0.41,0.62,0.96,0.00', '0.41,0.65,0.95,0.00', '0.42,0.69,0.95,0.00', '0.42,0.72,0.95,0.00', '0.42,0.75,0.95,0.00', '0.42,0.78,0.95,0.00', '0.41,0.80,0.95,0.00', '0.40,0.82,0.96,0.00', '0.39,0.85,0.96,0.00', 
  '0.37,0.86,0.96,0.00', '0.35,0.88,0.97,0.00', '0.32,0.90,0.98,0.00', '0.28,0.91,0.98,0.00', '0.22,0.93,0.98,0.00', '0.11,0.94,1.00,0.00', '0.16,0.93,0.99,0.00', '0.27,0.92,0.98,0.00', '0.35,0.91,0.96,0.00', '0.41,0.90,0.95,0.00', '0.47,0.89,0.93,0.00', 
  '0.53,0.88,0.90,0.00', '0.58,0.88,0.88,0.00', '0.62,0.87,0.85,0.00', '0.67,0.86,0.82,0.00', '0.70,0.85,0.78,0.00', '0.74,0.84,0.75,0.00', '0.78,0.84,0.72,0.00', '0.81,0.83,0.67,0.00', '0.84,0.82,0.63,0.00', '0.87,0.82,0.58,0.00', '0.91,0.81,0.51,0.00', 
  '0.93,0.81,0.45,0.00', '0.96,0.80,0.36,0.00', '0.99,0.80,0.23,0.00', '0.99,0.81,0.19,0.00', '1.00,0.81,0.16,0.00', '1.00,0.82,0.12,0.00', '1.00,0.83,0.07,0.00', '1.00,0.83,0.04,0.00', '1.00,0.82,0.09,0.00', '1.00,0.81,0.12,0.00', '1.00,0.80,0.14,0.00', 
  '1.00,0.80,0.16,0.00', '1.00,0.78,0.17,0.00', '1.00,0.77,0.18,0.00', '1.00,0.76,0.18,0.00', '1.00,0.75,0.19,0.00', '1.00,0.74,0.19,0.00', '1.00,0.72,0.20,0.00', '1.00,0.71,0.20,0.00', '1.00,0.69,0.20,0.00', '1.00,0.68,0.20,0.00', '1.00,0.66,0.20,0.00', 
  '1.00,0.64,0.20,0.00', '1.00,0.62,0.19,0.00', '1.00,0.60,0.18,0.00', '1.00,0.57,0.16,0.00', '1.00,0.54,0.15,0.00', '1.00,0.51,0.14,0.00', '1.00,0.47,0.13,0.00', '1.00,0.43,0.11,0.00', '1.00,0.39,0.10,0.00', '1.00,0.37,0.08,0.00', '1.00,0.36,0.06,0.00', 
  '1.00,0.33,0.05,0.00', '1.00,0.31,0.04,0.00', '1.00,0.29,0.02,0.00', '1.00,0.27,0.02,0.00', '1.00,0.26,0.01,0.00', '1.00,0.24,0.01,0.00', '1.00,0.22,0.00,0.00', '1.00,0.20,0.00,0.00', '1.00,0.18,0.00,0.00', '1.00,0.16,0.00,0.00', '1.00,0.15,0.00,0.00', 
  '1.00,0.13,0.00,0.00', '1.00,0.11,0.00,0.00', '1.00,0.09,0.00,0.00', '1.00,0.07,0.00,0.00', '1.00,0.05,0.00,0.00', '1.00,0.04,0.00,0.00', '1.00,0.02,0.00,0.00', '1.00,0.01,0.00,0.00', '1.00,0.00,0.00,0.00']

text:
  {% set temp = printer[param_sensor].temperature %}
  {% set steps = param_gradient|length %}
  {% set idx = (((temp - param_cool_temp) / (param_hot_temp - param_cool_temp)) * steps) | int %}
  {% if idx < 0 %} 
    {% set idx = 0 %}
  {% elif idx > steps-1 %}
    {% set idx = steps-1 %}
  {% endif %}
  { param_gradient[idx] }
  
